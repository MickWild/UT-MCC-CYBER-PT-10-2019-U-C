## Solution File: Malware and Password Problem Set 

### Solutions:

1. Which of the following is the weakest?
  - [ ] NTLMv1
  - [ ] Kerberos
  - [ ] NTLMv2
  - [x] LM

2. Which format is used to hash passwords on modern Windows machines?
  - [ ] DES
  - [ ] RC4
  - [x] NTLM
  - [ ] SHA512

3. Which hash format was used to generate the credentials below?
  
  ```bash
  admin::N46iSNekpT:08ca45b7d7ea58ee:88dcbe4446168966a153a0064958dac6:5c7830315c7830310000000000000b45c67103d07d7b95acd12ffa11230e0000000052920b85f78d013c31cdb3b92f5d765c783030
  ```

  - [ ] MD5
  - [x] NTLM
  - [ ] LM
  - [ ] 3DES

4. Which command would you use to crack the password hash below?

  ```bash
  299BD128C1101FD6
  ```
  - [ ] `john --format=nt hash.txt`
  - [x] `john --format=lm hash.txt`
  - [ ] `john --format=netntlm hash.txt`
  - [ ] `john --format=raw-md5 hash.txt`

5. Suppose you dump the following passwords from `/etc/shadow`. Which algorithm was used to generate them?

  ```bash
  $6$0LNgXS95nJv2B6hm$BRNf00hyT5xGNRnsLSSn3xDPXIs6l34g2kpex4mh0w/fvGz4MYs02qWjVU5NrbVktoNVNRsHU6MUTUua4J5nO0
  ```
  - [ ] MD5
  - [ ] Blowfish
  - [x] SHA512-Crypt
  - [ ] SHA256-Crypt

6. Suppose you dump the following passwords from `/etc/shadow`. Which algorithm was used to generate them?
  ```bash
  $1$3JUKmV3R$vZVeb51f1t6QZUecwuRHX0
  ```
  - [ ] SHA512-Crypt
  - [ ] Blowfish
  - [x] MD5
  - [ ] SHA256-Crypt

7. Which of the following exploits leverages a buffer overflow vulnerability?
  - [x] Heartbleed
  - [ ] Shellshock
  - [ ] BEAST
  - [ ] UAC Bypass

8. Which of the following is commonly achieved with a buffer overflow exploit? Check all that apply.
  - [x] Escalating privileges to `root`
  - [x] Shellcode Injection
  - [x] Reading Protected Memory
  - [ ] Dumping Remote Databases

9. What is the difference between a virus and a worm?
  - [x] A worm can spread without human interaction, whereas a virus must be downloaded or executed by a user.
  - [ ] A virus can infect multiple computers, but a worm can only infect one at a time.
  - [ ] A virus can copy itself perfectly, but worms change every time they copy themselves.
  - [ ] Worms are used for DoS, while viruses can be used for many things.

10. Which type of malware is most associated with spearphishing?
  - [ ] Worm
  - [ ] Virus
  - [x] Trojan
  - [ ] Ransomware

11. Which part of a computer does a bootkit infect?
  - [ ] NIC
  - [x] Master Boot Record
  - [ ] BIOS
  - [ ] Files

12. Which part of a computer does a Windows rootkit infect?
  - [ ] NIC
  - [ ] Master Boot Record
  - [x] BIOS
  - [ ] Files

13. Which ring does a kernel rootkit run in?
  - [x] Ring 0
  - [ ] Ring 1
  - [ ] Ring 2
  - [ ] Ring 7

14. Why are rootkits difficult to detect?
  - [ ] They are usually very small and hard to find.
  - [ ] Anti-Virus can't find them because they only execute in RAM.
  - [ ] Their code is obfuscated and hard to identify as malicious.
  - [x] They can bypass nearly all security controls because they run with full `root` privileges.

15. Which technique do viruses use to spread through Microsoft Word and Excel documents?
  - [ ] Cluster Infection
  - [ ] Multipartite Infection
  - [x] Macro Infection
  - [ ] Fast Infection

16. Which infection method is used by viruses that spread as fake PNG files?
  - [x] File Infection
  - [ ] Latent Infection
  - [ ] Cluster Infection
  - [ ] Hoax infection

17. During which phase of infection does a virus identify places to infect?
  - [ ] Infection Routine
  - [x] Search Routine
  - [ ] Payload Delivery
  - [ ] Anti-Detection Routine

18. Which of the following might happen when a virus runs its Trigger Routine? Check all that apply.
  - [ ] Uninstall itself.
  - [x] Communicate with a CC server.
  - [ ] Trigger the Anti-Virus scanner to see if it will be detected.
  - [x] Encrypt the disk so users can't access their data.

19. Which of the following can be used to generate Trojans? Check all that apply.
  - [x] `msfvenom`
  - [ ] `PowerView.ps1`
  - [ ] `PowerUp.ps1`
  - [x] Veil Framework

20. Which of the following can be used to read unencrypted passwords from RAM?
  - [ ] Empire
  - [x] Mimikatz
  - [ ] Metasploit
  - [ ] `hashcat`



Remind students to take note of any questions or topics that we did not cover or they did not know, so they can devote specific attention to those areas while they prep for the exam.  

Take a moment to address remaining questions before dismissing class.