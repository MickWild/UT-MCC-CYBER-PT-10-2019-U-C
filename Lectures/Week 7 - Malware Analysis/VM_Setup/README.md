## Virtual Box Setup

Make sure you have Virtual Box installed, from www.virtualbox.org

## Windows 10 Install

Microsoft makes Virtual Machines freely available to developers so that they can test out different applications across different Windows enviroments. Fortunatley, we can use this for our Malware analysis, too, with the understanding that the virual machines will expire after 90 days. Microsoft recommends setting a snapshot when you first install the VM so you can roll it back later. 

1. Navigate to https://developer.microsoft.com/en-us/microsoft-edge/tools/vms/ and select **MSEdge on Win 10 (x64) Stable** and then select the **VirtualBox** platform. 

2. Once downloaded, extract the contents of the .zip. After extraction, you'll want to open the **.ovf** file, importing it into Virtual Box. Go ahead and check the box for **Reinitalize the MAC address of all network cards** and leave the default settings for everythign else. Click **Import.**

## FlareVM Install

1. Boot up your Win 10 VM. After it boots, it will log in with the IEUser account. The password for this VM is `Passw0rd!` This is the default administrator account on this machine that Microsoft has set up. 

2. Next, open up PowerShell as an Administrator by clicking on the **Start Menu**, typing **PowerShell** and then **right clicking** on the icon before selecting **Run as administrator** and then select **yes**

3. Next type `Set-ExecutionPolicy Unrestricted` and then `Y` 

4. Now type `iex ((New-Object System.Net.WebClient).DownloadString('http://boxstarter.org/bootstrapper.ps1')); get-boxstarter -Force`
  - This installs Boxstarter, which we'll use to get FlareVM

5. Type `Import-Module c:\programdata\boxstarter\boxstarter.chocolatey\boxstarter.chocolatey.psm1`
  - This imports a module into the PowerShell enviroment for us. 

6. Next, install FlareVM with the following command: `Install-BoxstarterPackage -PackageName https://raw.githubusercontent.com/fireeye/flare-vm/master/install.ps1` This install is quite extensive (30-40 mins, depending on connection speed), and will cause several reboots. Once it is done, you'll be in a FlareVM instance of Windows 10. 